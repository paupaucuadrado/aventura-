<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Hydra Sublenguaje</title>
  <script src="https://unpkg.com/hydra-synth"></script>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      height: 100%;
      background: black;
    }

    canvas {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      z-index: 0;
    }

    #input {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      width: 80%;
      max-width: 600px;
      height: 80px;
      background: rgba(0, 0, 0, 0.5);
      color: white;
      font-size: 18px;
      border: 2px solid white;
      border-radius: 10px;
      padding: 10px;
      z-index: 10;
      backdrop-filter: blur(4px);
      resize: none;
    }
  </style>
</head>
<body>
  <textarea id="input" placeholder="Escribe: pabaras y letras cortas"></textarea>

  <script>
    const hydra = new Hydra({ detectAudio: false });

    const palabras = {
  periquin: () => voronoi(9,8,-0.5).rotate(()=>a.fft[0],2,-0.2).colorama(0.2).modulatePixelate(0.2,1),
volando: () => solid(2,0.5,89).layer(osc(85.5,0).thresh(5).luma().modulate(osc(4,1).rotate(1),0.05).color(-0.8,-0.5,20)).layer(osc(85,0).thresh(0.1).luma().modulate(osc(9,0.8).rotate(9),0.1)),
por: () => osc(100,-0.2,0.5).colorama().modulateRotate(osc(2,0.2,1).kaleid(4).scale(0.1),2,0).hue(-0.2).modulate(noise(-3,0)).modulatePixelate(voronoi(2)),
el: () => voronoi(-55,0.55,0.3).colorama(2,0.8,3).scale(-0.9,4,6).blend(noise([5,6,2,0],-3),4).out(o0)shape(7,0.3,0.2).colorama().modulateRotate(osc(1,5,2).kaleid(10).scale(-0.2),1).mult(osc([50,2,-100,2],-0.1,3)).out(o1)src(o2).modulateHue(o1,3).layer(o0,0.1),
cielo: () => voronoi(5,3,0.2).colorama(151).kaleid(5),
y: () => noise(7,0.5,3).add(shape(1)).colorama(.9).modulateRotate(osc(6,0.1,2).kaleid(65).scale(0.2),1,3).modulateScale(osc(50)).invert().mult(voronoi([2,-3,5,1],0.3,1)),
siendo: () => noise(10,0.5,8).mult(shape(12)).scale(2).colorama(.9).invert(-3).modulateRotate(osc(-2,0.5,1).kaleid(150).scale(0.6),5,15).out(o1)
src(o0).modulateHue(src(o0).add(1.03),5).blend(o1,0.01).out(),



magt : () => {
  osc(40,0.5,() => a.fft[0]*200).out(o2)
  let shape = osc(60, 0.1, 2)
    .mult(noise(1, 4))
    .rotate(() => (Math.random() - 0.5) * 0.5 + Math.sin(time * 0.2) * 0.2)
  shape.out(o0)
  return shape
},
};

    const input = document.getElementById("input");

    input.addEventListener("input", () => {
      const texto = input.value.toLowerCase().trim();

      // Si contiene comas: modulaci贸n encadenada
      if (texto.includes(",")) {
        const modWords = texto.split(",").map(w => w.trim()).filter(w => palabras[w]);
        if (modWords.length >= 2) {
          let base = palabras[modWords[0]]();
          for (let i = 1; i < modWords.length; i++) {
            base = palabras[modWords[i]]().modulate(base, 0.5 + 0.3 * Math.random()); // modulaci贸n aleatoria
          }
          base.out();
          return;
        }
      }

      // Si contiene comas: modulaci贸n encadenada
      if (texto.includes("x")) {
        const modWords = texto.split(",").map(w => w.trim()).filter(w => palabras[w]);
        if (modWords.length >= 2) {
          let base = palabras[modWords[0]]();
          for (let i = 1; i < modWords.length; i++) {
            base = palabras[modWords[i]]().modulateScale(base, 0.5 + 0.3 * Math.random()); // modulaci贸n aleatoria
          }
          base.out();
          return;
        }
      }

      // Si no hay coma, renderiza todo en capas independientes
      const entradas = texto.split(/\s+/).map(w => w.trim()).filter(w => palabras[w]);
      if (entradas.length > 0) {
        // Componer blend entre todas
        let comp = palabras[entradas[0]]();
        for (let i = 1; i < entradas.length; i++) {
          comp = comp.diff(palabras[entradas[i]](), 0.5);
        }
        comp.out();
      }
    });
  </script>
</body>
</html>
